module.exports=[17490,a=>{"use strict";var b=a.i(42093),c=a.i(85455),d=a.i(99026),e=a.i(64964);a.i(56120);var f=a.i(83750),g=a.i(83357),h=a.i(22448),i=a.i(37717),j=a.i(27965),k=a.i(93391),l=a.i(69708),m=a.i(2042),n=a.i(32056);let o={new:"bg-blue-100 text-blue-800",contacted:"bg-yellow-100 text-yellow-800",qualified:"bg-green-100 text-green-800",meeting_scheduled:"bg-purple-100 text-purple-800",converted:"bg-gray-100 text-gray-800",lost:"bg-red-100 text-red-800"},p=[{value:"new",label:"New"},{value:"contacted",label:"Contacted"},{value:"qualified",label:"Qualified"},{value:"meeting_scheduled",label:"Meeting Scheduled"},{value:"converted",label:"Converted"},{value:"lost",label:"Lost"}];function q({lead:a,onUpdate:d}){let[e,f]=c.useState(!1),g=async b=>{if(b===a.status)return void f(!1);d(a.id,b);try{await (0,j.updateLeadStatus)(a.id,b),l.showToast.success(`Status updated to ${b}`)}catch(b){d(a.id,a.status),l.showToast.error("Failed to update status")}f(!1)};return(0,b.jsxs)(m.DropdownMenu,{open:e,onOpenChange:f,children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{className:"flex items-center gap-1 hover:opacity-80 transition-opacity",suppressHydrationWarning:!0,children:[(0,b.jsx)(i.Badge,{className:o[a.status],children:a.status}),(0,b.jsx)(n.ChevronDown,{className:"size-3 text-muted-foreground"})]})}),(0,b.jsx)(m.DropdownMenuContent,{align:"start",children:p.map(c=>(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>g(c.value),className:c.value===a.status?"bg-muted":"",children:c.label},c.value))})]})}var r=a.i(56545);let s=["You","Admin","Editor A","Editor B"];function t({lead:a,onUpdate:d}){let[e,f]=c.useState(!1),g=async b=>{if(b===a.owner)return void f(!1);d(a.id,b);try{await (0,j.updateLeadOwner)(a.id,b),l.showToast.success(b?`Assigned to ${b}`:"Unassigned")}catch(b){d(a.id,a.owner),l.showToast.error("Failed to update owner")}f(!1)};return(0,b.jsxs)(m.DropdownMenu,{open:e,onOpenChange:f,children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{className:"flex items-center gap-1 hover:opacity-80 transition-opacity text-sm",suppressHydrationWarning:!0,children:[a.owner?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.User,{className:"size-3"}),(0,b.jsx)("span",{children:a.owner})]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"Unassigned"}),(0,b.jsx)(n.ChevronDown,{className:"size-3 text-muted-foreground"})]})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"start",children:[(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>g(void 0),children:(0,b.jsx)("span",{className:"text-muted-foreground",children:"Unassigned"})}),s.map(c=>(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>g(c),className:c===a.owner?"bg-muted":"",children:c},c))]})]})}var u=a.i(27725),v=a.i(84659),w=a.i(9843),x=a.i(27976);let y=[{value:"new",label:"New"},{value:"contacted",label:"Contacted"},{value:"qualified",label:"Qualified"},{value:"meeting_scheduled",label:"Meeting Scheduled"},{value:"converted",label:"Converted"},{value:"lost",label:"Lost"}],z=["You","Admin","Editor A","Editor B"];function A({selectedLeads:a,onBulkStatusUpdate:d,onBulkOwnerAssign:e,onClearSelection:f}){let[g,h]=c.useState(!1),[i,j]=c.useState(!1);if(0===a.length)return null;let k=b=>{e(a.map(a=>a.id),b),j(!1)};return(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-md border bg-muted/50 px-4 py-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-sm font-medium",children:[a.length," selected"]}),(0,b.jsxs)(u.Button,{variant:"ghost",size:"sm",onClick:f,className:"h-7",children:[(0,b.jsx)(x.X,{className:"mr-1 size-3"}),"Clear"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(m.DropdownMenu,{open:g,onOpenChange:h,children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",className:"h-7",suppressHydrationWarning:!0,children:[(0,b.jsx)(w.Tag,{className:"mr-2 size-3"}),"Update Status"]})}),(0,b.jsx)(m.DropdownMenuContent,{align:"end",children:y.map(c=>(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>{var b;return b=c.value,void(d(a.map(a=>a.id),b),h(!1))},children:c.label},c.value))})]}),(0,b.jsxs)(m.DropdownMenu,{open:i,onOpenChange:j,children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",className:"h-7",suppressHydrationWarning:!0,children:[(0,b.jsx)(r.User,{className:"mr-2 size-3"}),"Assign Owner"]})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>k(void 0),children:(0,b.jsx)("span",{className:"text-muted-foreground",children:"Unassigned"})}),z.map(a=>(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>k(a),children:a},a))]})]}),(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",onClick:()=>{l.showToast.info(`Exporting ${a.length} lead(s)...`)},className:"h-7",children:[(0,b.jsx)(v.Download,{className:"mr-2 size-3"}),"Export"]})]})]})}var B=a.i(48593);let C=(0,a.i(28761).default)("bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),D=[{id:"my-new-leads",name:"My New Leads",params:{owner:"You",status:"new"}},{id:"qualified-high-fit",name:"Qualified – High Fit",params:{status:"qualified"}},{id:"facebook-this-week",name:"Facebook – This Week",params:{source:"Facebook"}}];function E(){let a=(0,d.useRouter)(),e=(0,d.useSearchParams)(),[f,g]=c.useState([]),[h,i]=c.useState(!1);return(c.useEffect(()=>{g(function(){try{let a=localStorage.getItem("prosfin-saved-views");if(a)return JSON.parse(a)}catch(a){}return D}()),i(!0)},[]),h)?(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",className:"h-8",suppressHydrationWarning:!0,children:[(0,b.jsx)(B.Filter,{className:"mr-2 size-3"}),"Views",(0,b.jsx)(n.ChevronDown,{className:"ml-2 size-3"})]})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"end",className:"w-56",children:[f.map(c=>(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>{let b;return b=new URLSearchParams,void(Object.entries(c.params).forEach(([a,c])=>{c&&b.set(a,c)}),e.forEach((a,d)=>{c.params[d]||"view"===d||b.set(d,a)}),b.set("view",c.id),a.push(`/leads?${b.toString()}`),l.showToast.info(`Applied view: ${c.name}`))},className:e.get("view")===c.id?"bg-muted":"",children:[(0,b.jsx)(C,{className:"mr-2 size-3"}),c.name]},c.id)),(0,b.jsx)(m.DropdownMenuSeparator,{}),(0,b.jsx)(m.DropdownMenuItem,{disabled:!0,className:"text-muted-foreground text-xs",children:"Save current view (coming soon)"})]})]}):null}var F=a.i(77979);let G={new:"bg-blue-100 text-blue-800",contacted:"bg-yellow-100 text-yellow-800",qualified:"bg-green-100 text-green-800",meeting_scheduled:"bg-purple-100 text-purple-800",converted:"bg-gray-100 text-gray-800",lost:"bg-red-100 text-red-800"};function H(){let a=(0,d.useRouter)(),[n,o]=c.useState([]),[p,r]=c.useState(!0),[s,v]=c.useState([]),[w,y]=c.useState(!1),[z,C]=c.useState(null),[D,H]=(0,k.useUrlState)("q","",{debounce:300,replace:!0}),[I,J]=(0,k.useUrlStateArray)("status",[]),[K,L]=(0,k.useUrlState)("source",""),[M,N]=(0,k.useUrlState)("owner",""),[O,P]=(0,k.useUrlState)("interest",""),[Q,R]=(0,k.useUrlState)("utm_campaign",""),[S,T]=(0,k.useUrlState)("page","0"),U=c.useMemo(()=>{let a=parseInt(S,10);return isNaN(a)||a<0?0:a},[S]),V=c.useCallback(a=>{T(String(a))},[T]);c.useEffect(()=>{(0,j.listLeads)().then(a=>{o(a),r(!1)})},[]);let W=c.useMemo(()=>{let a=[...n];if(D){let b=D.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(b)||a.email.toLowerCase().includes(b)||a.phone?.toLowerCase().includes(b)||a.company?.toLowerCase().includes(b))}return I.length>0&&(a=a.filter(a=>I.includes(a.status))),K&&(a=a.filter(a=>a.source===K)),M&&(a="unassigned"===M?a.filter(a=>!a.owner):a.filter(a=>a.owner===M)),O&&(a=a.filter(a=>a.interest===O)),Q&&(a=a.filter(a=>a.utm_campaign===Q)),a},[n,D,I,K,M,O,Q]),X=async(a,b)=>{try{await (0,j.updateLeadStatus)(a,b),o(c=>c.map(c=>c.id===a?{...c,status:b}:c)),l.showToast.success(`Lead status updated to ${b}`)}catch(a){l.showToast.error("Failed to update lead status")}},Y=async(a,b)=>{try{await (0,j.updateLeadOwner)(a,b),o(c=>c.map(c=>c.id===a?{...c,owner:b}:c)),l.showToast.success(b?`Assigned to ${b}`:"Unassigned")}catch(a){l.showToast.error("Failed to update owner")}},Z=async(a,b)=>{try{await Promise.all(a.map(a=>(0,j.updateLeadStatus)(a,b))),o(c=>c.map(c=>a.includes(c.id)?{...c,status:b}:c)),v([]),l.showToast.success(`Updated ${a.length} lead(s) to ${b}`)}catch(a){l.showToast.error("Failed to update leads")}},$=async(a,b)=>{try{await Promise.all(a.map(a=>(0,j.updateLeadOwner)(a,b))),o(c=>c.map(c=>a.includes(c.id)?{...c,owner:b}:c)),v([]),l.showToast.success(b?`Assigned ${a.length} lead(s) to ${b}`:`Unassigned ${a.length} lead(s)`)}catch(a){l.showToast.error("Failed to update leads")}},_=[{label:"Mark as Contacted",onClick:a=>X(a.id,"contacted")},{label:"Change Status",onClick:b=>{a.push(`/leads/${b.id}`)}},{label:"Convert to Client",onClick:a=>{C(a),y(!0)}},{label:"Export",onClick:a=>{let b,c,d;return b=new Blob([["Name,Company,Email,Phone,Status,Owner,Source",[a.name,a.company||"",a.email,a.phone||"",a.status,a.owner||"",a.source].join(",")].join("\n")],{type:"text/csv"}),c=URL.createObjectURL(b),void((d=document.createElement("a")).href=c,d.download=`lead-${a.id}.csv`,d.click(),URL.revokeObjectURL(c),l.showToast.success("Lead exported"))}}],aa={low:"bg-gray-100 text-gray-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"},ab=c.useMemo(()=>{let a=new Set;return n.forEach(b=>{b.owner&&a.add(b.owner)}),Array.from(a).sort()},[n]),ac=c.useMemo(()=>{let a=new Set;return n.forEach(b=>{b.interest&&a.add(b.interest)}),Array.from(a).sort()},[n]),ad=c.useMemo(()=>{let a=new Set;return n.forEach(b=>{b.source&&a.add(b.source)}),Array.from(a).sort()},[n]),ae=(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",className:"h-8",children:[(0,b.jsx)(B.Filter,{className:"mr-2 size-3"}),"Status",I.length>0&&(0,b.jsx)("span",{className:"ml-2 rounded-full bg-primary px-1.5 py-0.5 text-xs text-primary-foreground",children:I.length})]})}),(0,b.jsx)(m.DropdownMenuContent,{align:"start",className:"w-48",children:Object.entries(G).map(([a,c])=>(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>{J(I.includes(a)?I.filter(b=>b!==a):[...I,a])},children:[(0,b.jsx)("input",{type:"checkbox",checked:I.includes(a),onChange:()=>{},className:"mr-2"}),a]},a))})]}),(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",className:"h-8",children:[(0,b.jsx)(B.Filter,{className:"mr-2 size-3"}),"Owner",M&&(0,b.jsx)(x.X,{className:"ml-2 size-3",onClick:a=>{a.stopPropagation(),N("")}})]})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"start",className:"w-48",children:[(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>N("unassigned"),children:"Unassigned"}),ab.map(a=>(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>N(a),children:a},a))]})]}),(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",className:"h-8",children:[(0,b.jsx)(B.Filter,{className:"mr-2 size-3"}),"Interest",O&&(0,b.jsx)(x.X,{className:"ml-2 size-3",onClick:a=>{a.stopPropagation(),P("")}})]})}),(0,b.jsx)(m.DropdownMenuContent,{align:"start",className:"w-48",children:ac.map(a=>(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>P(a),children:a},a))})]}),(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(u.Button,{variant:"outline",size:"sm",className:"h-8",children:[(0,b.jsx)(B.Filter,{className:"mr-2 size-3"}),"Source",K&&(0,b.jsx)(x.X,{className:"ml-2 size-3",onClick:a=>{a.stopPropagation(),L("")}})]})}),(0,b.jsx)(m.DropdownMenuContent,{align:"start",className:"w-48",children:ad.map(a=>(0,b.jsx)(m.DropdownMenuItem,{onClick:()=>L(a),children:a},a))})]})]}),af=[{id:"name",header:"Name",accessorKey:"name",enableSorting:!0},{id:"company",header:"Company",accessorKey:"company",enableSorting:!0},{id:"email",header:"Email",accessorKey:"email"},{id:"phone",header:"Phone",accessorKey:"phone"},{id:"interest",header:"Service Interest",accessorKey:"interest",cell:({row:a})=>a.original.interest?(0,b.jsx)(i.Badge,{variant:"outline",children:a.original.interest}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"—"})},{id:"urgency",header:"Urgency",accessorKey:"urgency",cell:({row:a})=>a.original.urgency?(0,b.jsx)(i.Badge,{className:aa[a.original.urgency],children:a.original.urgency}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"—"})},{id:"status",header:"Status",accessorKey:"status",cell:({row:a})=>(0,b.jsx)(q,{lead:a.original,onUpdate:X})},{id:"owner",header:"Owner",accessorKey:"owner",cell:({row:a})=>(0,b.jsx)(t,{lead:a.original,onUpdate:Y})},{id:"source",header:"Source",accessorKey:"source"},{id:"utm_campaign",header:"UTM Campaign",accessorKey:"utm_campaign",cell:({row:a})=>a.original.utm_campaign?(0,b.jsx)("span",{className:"text-sm",children:a.original.utm_campaign}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"—"})},{id:"createdAt",header:"Created",accessorKey:"createdAt",cell:({row:a})=>(0,e.format)(new Date(a.original.createdAt),"MMM dd, yyyy")},{id:"updatedAt",header:"Updated",accessorKey:"updatedAt",cell:({row:a})=>(0,e.format)(new Date(a.original.updatedAt),"MMM dd, yyyy")},{id:"actions",header:"",cell:({row:a})=>(0,b.jsx)(h.TableRowActions,{row:a.original,actions:_})}];return(0,b.jsxs)(f.AdminPageShell,{title:"Leads",description:"Manage and track your leads",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[s.length>0&&(0,b.jsx)(A,{selectedLeads:s,onBulkStatusUpdate:Z,onBulkOwnerAssign:$,onClearSelection:()=>v([])}),(0,b.jsx)(g.AppDataTable,{columns:af,data:W,isLoading:p,searchPlaceholder:"Search leads...",emptyMessage:"No leads found",searchValue:D,onSearchChange:H,pageIndex:U,onPageChange:V,enableRowSelection:!0,onSelectionChange:v,filters:ae,toolbarRightActions:(0,b.jsx)(E,{}),onRowClick:b=>{a.push(`/leads/${b.id}`)}})]}),z&&(0,b.jsx)(F.ConvertLeadDialog,{lead:z,open:w,onOpenChange:a=>{y(a),a||C(null)},onConverted:a=>{l.showToast.success("Lead converted successfully"),y(!1),C(null)}})]})}a.s(["default",()=>H],17490)}];

//# sourceMappingURL=apps_admin_src_app_%28app%29_leads_page_tsx_5ef46747._.js.map