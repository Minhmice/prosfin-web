module.exports=[155,a=>{"use strict";var b=a.i(42093),c=a.i(85455),d=a.i(99026),e=a.i(64964);a.i(56120);var f=a.i(83750),g=a.i(37717),h=a.i(27725),i=a.i(2042),j=a.i(83357),k=a.i(22448),l=a.i(92365),m=a.i(6334),n=a.i(18416),o=a.i(51367),p=a.i(29274),q=a.i(62584),r=a.i(76899),s=a.i(49861),t=a.i(78974),u=a.i(39226),v=a.i(69708);let w=[{label:"Facebook",value:"facebook",source:"facebook",medium:"paid_social"},{label:"YouTube",value:"youtube",source:"youtube",medium:"video"},{label:"TikTok",value:"tiktok",source:"tiktok",medium:"paid_social"},{label:"LinkedIn",value:"linkedin",source:"linkedin",medium:"paid_social"},{label:"Email",value:"email",source:"newsletter",medium:"email"},{label:"Other",value:"other",source:"",medium:""}];function x({onSave:a}){let[d,e]=c.useState({name:"",destinationUrl:"https://prosfin.vn",utm_source:"",utm_medium:"",utm_campaign:"",utm_content:"",utm_term:"",notes:"",tags:""}),[f,g]=c.useState(null),[i,j]=c.useState(!0),[k,x]=c.useState(""),[y,z]=c.useState(null),[A,B]=c.useState(""),[C,D]=c.useState(!1);c.useEffect(()=>{if(d.destinationUrl&&d.utm_source&&d.utm_medium&&d.utm_campaign){if(!(0,u.isValidUrl)(d.destinationUrl)){B("Invalid URL format"),x("");return}B(""),x((0,u.generateUTMLink)({destinationUrl:d.destinationUrl,utm_source:(0,u.normalizeUTMValue)(d.utm_source),utm_medium:(0,u.normalizeUTMValue)(d.utm_medium),utm_campaign:(0,u.normalizeUTMValue)(d.utm_campaign),utm_content:d.utm_content?(0,u.normalizeUTMValue)(d.utm_content):void 0,utm_term:d.utm_term?(0,u.normalizeUTMValue)(d.utm_term):void 0,keepExistingParams:i}))}else x("")},[d,i]);let E=async a=>{let b="";b="url"===a?k:"short"===a?(0,u.generateShortLabel)({channelPreset:f||void 0,utm_campaign:(0,u.normalizeUTMValue)(d.utm_campaign),destinationUrl:d.destinationUrl}):new URL(k).search.substring(1),await navigator.clipboard.writeText(b),z(a),v.showToast.success(`Copied ${"url"===a?"URL":"short"===a?"short label":"UTM params"}`),setTimeout(()=>z(null),2e3)},F=async()=>{if(!d.name||!k)return void v.showToast.error("Please fill in required fields");D(!0);try{await a({name:d.name,destinationUrl:d.destinationUrl,utm_source:(0,u.normalizeUTMValue)(d.utm_source),utm_medium:(0,u.normalizeUTMValue)(d.utm_medium),utm_campaign:(0,u.normalizeUTMValue)(d.utm_campaign),utm_content:d.utm_content?(0,u.normalizeUTMValue)(d.utm_content):void 0,utm_term:d.utm_term?(0,u.normalizeUTMValue)(d.utm_term):void 0,channelPreset:f||void 0,notes:d.notes||void 0,tags:d.tags?d.tags.split(",").map(a=>a.trim()):void 0,keepExistingParams:i}),e({name:"",destinationUrl:"https://prosfin.vn",utm_source:"",utm_medium:"",utm_campaign:"",utm_content:"",utm_term:"",notes:"",tags:""}),g(null),x("")}finally{D(!1)}},G=d.name&&d.destinationUrl&&d.utm_source&&d.utm_medium&&d.utm_campaign&&!A;return(0,b.jsx)(l.AdminSectionCard,{title:"UTM Builder",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h4",{className:"text-sm font-medium",children:"Destination URL"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{htmlFor:"destinationUrl",children:"URL *"}),(0,b.jsx)(m.Input,{id:"destinationUrl",value:d.destinationUrl,onChange:a=>e(b=>({...b,destinationUrl:a.target.value})),placeholder:"https://prosfin.vn/services",className:A?"border-destructive":""}),A&&(0,b.jsxs)("p",{className:"text-xs text-destructive mt-1 flex items-center gap-1",children:[(0,b.jsx)(t.AlertCircle,{className:"size-3"})," ",A]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.Switch,{checked:i,onCheckedChange:j,id:"keepParams"}),(0,b.jsx)(n.Label,{htmlFor:"keepParams",className:"text-sm font-normal",children:"Keep existing query params"})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h4",{className:"text-sm font-medium",children:"Channel Preset"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:w.map(a=>(0,b.jsx)(h.Button,{variant:f===a.value?"default":"outline",size:"sm",onClick:()=>{g(a.value),e(b=>({...b,utm_source:a.source,utm_medium:a.medium}))},children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h4",{className:"text-sm font-medium",children:"Campaign Parameters"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(n.Label,{htmlFor:"utm_source",children:["UTM Source * ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(referrer)"})]}),(0,b.jsx)(m.Input,{id:"utm_source",value:d.utm_source,onChange:a=>e(b=>({...b,utm_source:a.target.value})),placeholder:"facebook, google, newsletter"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(n.Label,{htmlFor:"utm_medium",children:["UTM Medium * ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(marketing medium)"})]}),(0,b.jsx)(m.Input,{id:"utm_medium",value:d.utm_medium,onChange:a=>e(b=>({...b,utm_medium:a.target.value})),placeholder:"paid_social, email, cpc"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(n.Label,{htmlFor:"utm_campaign",children:["UTM Campaign * ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(campaign name)"})]}),(0,b.jsx)(m.Input,{id:"utm_campaign",value:d.utm_campaign,onChange:a=>e(b=>({...b,utm_campaign:a.target.value})),placeholder:"prosfin_audit_2024w01"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(n.Label,{htmlFor:"utm_content",children:["UTM Content ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(creative variant)"})]}),(0,b.jsx)(m.Input,{id:"utm_content",value:d.utm_content,onChange:a=>e(b=>({...b,utm_content:a.target.value})),placeholder:"hookA_reel_v1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(n.Label,{htmlFor:"utm_term",children:["UTM Term ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(keyword)"})]}),(0,b.jsx)(m.Input,{id:"utm_term",value:d.utm_term,onChange:a=>e(b=>({...b,utm_term:a.target.value})),placeholder:"finance_tips"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h4",{className:"text-sm font-medium",children:"Internal Label & Notes"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(n.Label,{htmlFor:"name",children:["Name * ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(internal label)"})]}),(0,b.jsx)(m.Input,{id:"name",value:d.name,onChange:a=>e(b=>({...b,name:a.target.value})),placeholder:"FB | Summer 2024 | Audit Service | W01"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{htmlFor:"notes",children:"Notes"}),(0,b.jsx)(o.Textarea,{id:"notes",value:d.notes,onChange:a=>e(b=>({...b,notes:a.target.value})),placeholder:"Campaign notes...",rows:2})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(n.Label,{htmlFor:"tags",children:["Tags ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(comma-separated)"})]}),(0,b.jsx)(m.Input,{id:"tags",value:d.tags,onChange:a=>e(b=>({...b,tags:a.target.value})),placeholder:"summer, audit, facebook"})]})]}),k&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h4",{className:"text-sm font-medium",children:"Generated URL"}),(0,b.jsx)("div",{className:"rounded-md border bg-muted p-3",children:(0,b.jsx)("p",{className:"break-all text-sm font-mono",children:k})}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>E("url"),children:["url"===y?(0,b.jsx)(r.Check,{className:"mr-2 size-4"}):(0,b.jsx)(q.Copy,{className:"mr-2 size-4"}),"Copy URL"]}),(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>E("short"),children:["short"===y?(0,b.jsx)(r.Check,{className:"mr-2 size-4"}):(0,b.jsx)(q.Copy,{className:"mr-2 size-4"}),"Copy Short Label"]}),(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>E("utm"),children:["utm"===y?(0,b.jsx)(r.Check,{className:"mr-2 size-4"}):(0,b.jsx)(q.Copy,{className:"mr-2 size-4"}),"Copy UTM Only"]}),(0,b.jsxs)(h.Button,{onClick:F,disabled:!G||C,children:[(0,b.jsx)(s.Save,{className:"mr-2 size-4"}),C?"Saving...":"Save to History"]})]})]})]})})}var y=a.i(37204),z=a.i(32056);let A={active:"bg-green-100 text-green-800",paused:"bg-yellow-100 text-yellow-800",archived:"bg-gray-100 text-gray-800"},B=[{value:"active",label:"Active",needsNotes:!1},{value:"paused",label:"Paused",needsNotes:!0},{value:"archived",label:"Archived",needsNotes:!0}];function C({campaign:a,onUpdate:d,onNeedsNotes:e}){let[f,h]=c.useState(!1);return(0,b.jsxs)(i.DropdownMenu,{open:f,onOpenChange:h,children:[(0,b.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{className:"flex items-center gap-1 hover:opacity-80 transition-opacity",onClick:a=>a.stopPropagation(),suppressHydrationWarning:!0,children:[(0,b.jsx)(g.Badge,{className:A[a.status],children:a.status}),(0,b.jsx)(z.ChevronDown,{className:"size-3 text-muted-foreground"})]})}),(0,b.jsx)(i.DropdownMenuContent,{align:"start",children:B.map(c=>(0,b.jsxs)(i.DropdownMenuItem,{onClick:b=>{var f,g;b.stopPropagation(),f=c.value,g=c.needsNotes,f===a.status||(g&&e?e(a.id,f):d(a.id,f)),h(!1)},className:c.value===a.status?"bg-muted":"",children:[(0,b.jsx)(g.Badge,{className:`mr-2 ${A[c.value]}`,children:c.label}),c.needsNotes&&c.value!==a.status&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"(requires note)"})]},c.value))})]})}var D=a.i(12691),E=a.i(48593),F=a.i(27976),G=a.i(93391);let H={active:"bg-green-100 text-green-800",paused:"bg-yellow-100 text-yellow-800",archived:"bg-gray-100 text-gray-800"},I={facebook:"Facebook",youtube:"YouTube",tiktok:"TikTok",linkedin:"LinkedIn",email:"Email",other:"Other"};function J(){let a=(0,d.useRouter)(),[l,m]=c.useState([]),[n,o]=c.useState(!0),[p,q]=c.useState(!1),[r,s]=c.useState(null),[t,w]=c.useState(null),[z,A]=(0,G.useUrlState)("q","",{debounce:300,replace:!0}),[B,J]=(0,G.useUrlStateArray)("status",[]),[K,L]=(0,G.useUrlState)("channel",""),[M,N]=(0,G.useUrlState)("page","0"),O=c.useMemo(()=>{let a=parseInt(M,10);return isNaN(a)||a<0?0:a},[M]),P=c.useCallback(a=>{N(String(a))},[N]);c.useEffect(()=>{(0,u.listCampaigns)().then(a=>{m(a),o(!1)})},[]);let Q=c.useMemo(()=>{let a=[...l];if(a=0===B.length?a.filter(a=>"archived"!==a.status):a.filter(a=>B.includes(a.status)),z){let b=z.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(b)||a.utm_campaign.toLowerCase().includes(b))}return K&&(a=a.filter(a=>a.channelPreset===K)),a},[l,z,B,K]),R=async a=>{try{let b=await (0,u.createCampaign)(a);m(a=>[...a,b]),v.showToast.success("Campaign saved successfully")}catch(a){v.showToast.error("Failed to save campaign")}},S=async(a,b)=>{try{await (0,u.updateCampaignStatus)(a,b),m(c=>c.map(c=>c.id===a?{...c,status:b}:c)),v.showToast.success(`Campaign ${b}`)}catch(a){v.showToast.error("Failed to update status")}},T=(a,b)=>{let c=l.find(b=>b.id===a);c&&(s(c),w(b),q(!0))},U=async a=>{try{let b=await (0,u.duplicateCampaign)(a.id);m(a=>[...a,b]),v.showToast.success("Campaign duplicated")}catch(a){v.showToast.error("Failed to duplicate campaign")}},V=[{label:"View Details",onClick:b=>a.push(`/campaigns/${b.id}`)},{label:"Duplicate",onClick:a=>U(a)},{label:"Pause",onClick:a=>T(a.id,"paused")},{label:"Archive",onClick:a=>T(a.id,"archived"),variant:"destructive"}],W=[{id:"name",header:"Name",accessorKey:"name",enableSorting:!0},{id:"status",header:"Status",accessorKey:"status",cell:({row:a})=>(0,b.jsx)(C,{campaign:a.original,onUpdate:S,onNeedsNotes:T})},{id:"channel",header:"Channel",accessorKey:"channelPreset",cell:({row:a})=>a.original.channelPreset?(0,b.jsx)(g.Badge,{variant:"outline",children:I[a.original.channelPreset]}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"â€”"})},{id:"destination",header:"Destination",accessorKey:"destinationUrl",cell:({row:a})=>(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:((a,b=40)=>{try{let c=new URL(a),d=c.hostname+c.pathname;return d.length>b?d.substring(0,b)+"...":d}catch{return a.length>b?a.substring(0,b)+"...":a}})(a.original.destinationUrl)})},{id:"utm_campaign",header:"Campaign",accessorKey:"utm_campaign"},{id:"utm_source",header:"Source",accessorKey:"utm_source"},{id:"utm_medium",header:"Medium",accessorKey:"utm_medium"},{id:"updatedAt",header:"Updated",accessorKey:"updatedAt",cell:({row:a})=>(0,e.format)(new Date(a.original.updatedAt),"MMM dd, yyyy")},{id:"copy",header:"",cell:({row:a})=>(0,b.jsx)(y.CopyFlows,{campaign:a.original,variant:"icons"})},{id:"actions",header:"",cell:({row:a})=>(0,b.jsx)(k.TableRowActions,{row:a.original,actions:V})}],X=(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(i.DropdownMenu,{children:[(0,b.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",className:"h-8",children:[(0,b.jsx)(E.Filter,{className:"mr-2 size-3"}),"Status",B.length>0&&(0,b.jsx)("span",{className:"ml-2 rounded-full bg-primary px-1.5 py-0.5 text-xs text-primary-foreground",children:B.length})]})}),(0,b.jsx)(i.DropdownMenuContent,{align:"start",className:"w-48",children:["active","paused","archived"].map(a=>(0,b.jsxs)(i.DropdownMenuItem,{onClick:()=>{J(B.includes(a)?B.filter(b=>b!==a):[...B,a])},children:[(0,b.jsx)("input",{type:"checkbox",checked:B.includes(a),onChange:()=>{},className:"mr-2"}),(0,b.jsx)(g.Badge,{className:H[a],children:a})]},a))})]}),(0,b.jsxs)(i.DropdownMenu,{children:[(0,b.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",className:"h-8",children:[(0,b.jsx)(E.Filter,{className:"mr-2 size-3"}),"Channel",K&&(0,b.jsx)(F.X,{className:"ml-2 size-3",onClick:a=>{a.stopPropagation(),L("")}})]})}),(0,b.jsx)(i.DropdownMenuContent,{align:"start",className:"w-48",children:Object.keys(I).map(a=>(0,b.jsx)(i.DropdownMenuItem,{onClick:()=>L(a),children:I[a]},a))})]})]});return(0,b.jsxs)(f.AdminPageShell,{title:"Campaigns",description:"Create and manage UTM campaign links",children:[(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsx)(x,{onSave:R}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Campaign History"}),(0,b.jsx)(j.AppDataTable,{columns:W,data:Q,isLoading:n,searchPlaceholder:"Search campaigns...",emptyMessage:"No campaigns found",searchValue:z,onSearchChange:A,pageIndex:O,onPageChange:P,filters:X,onRowClick:b=>a.push(`/campaigns/${b.id}`)})]})]}),(0,b.jsx)(D.StatusChangeDialog,{campaign:r,targetStatus:t,open:p,onOpenChange:q,onStatusChanged:(a,b)=>{m(c=>c.map(c=>c.id===a?{...c,status:b}:c))}})]})}a.s(["default",()=>J],155)}];

//# sourceMappingURL=apps_admin_src_app_%28app%29_campaigns_page_tsx_e751f4b9._.js.map